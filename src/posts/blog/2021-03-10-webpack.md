---
icon: "ğŸ’»"
title: 'Webpack'
category: "FrontEnd"
date: "2021-03-10 12:00:00 +09:00"
desc: "JavaScript"
thumbnail: "./images/markdown-test/thumbnail.jpg"
alt: "markdown logo"
---


# Webpack
- htmlì€ í•˜ë‚˜ì˜ JavaScript íŒŒì¼ë§Œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆëŠ”ë° Webpackì„ ì‚¬ìš©í•˜ë©´ ìë°”ìŠ¤í¬ë¦½íŠ¸, css, ì´ë¯¸ì§€ ë“±ì„ **í•˜ë‚˜ì˜ íŒŒì¼ë¡œ ë¬¶ì–´ì„œ ë‚´ë³´ë‚¼ ìˆ˜ ìˆë‹¤**
- ìë°”ìŠ¤í¬ë¦½íŠ¸, css, ì´ë¯¸ì§€ ë“±ì„ ëª¨ë“ˆì´ë¼ê³  ë¶€ë¥´ë©° Webpackì€ ì´ë“¤ì„ ë¬¶ëŠ” ëª¨ë“ˆ ë²ˆë“¤ëŸ¬ (Module Bundler)ì´ë‹¤

## ì„¤ì¹˜
- webpack - ëª¨ë“ˆ ë²ˆë“¤ëŸ¬
- webpack-cli - ì›¹íŒ©ì˜ ì»¤ë§¨ë“œ ë¼ì¸ ì¸í„°í˜ì´ìŠ¤


```
npm i -D webpack
npm i -D webpack-cli
```

## ì‹¤í–‰
ì‹¤í–‰ì‹œ webpackì´ë¼ê³  ì ìœ¼ë©´ ëª…ë ¹ì–´ë¡œ ë“±ë¡ì´ ì•ˆë˜ì–´ìˆìœ¼ë¯€ë¡œ ì¸ì‹í•  ìˆ˜ ìˆê²Œ í•´ì¤˜ì•¼ í•œë‹¤
- 1. ëª…ë ¹ì–´ë¡œ ë“±ë¡ í•œë‹¤
- 2. scriptsì— ì ì–´ì£¼ê³  `npm run [script ëª…ë ¹ì–´]` ë¡œ ì‹¤í–‰í•œë‹¤
  - `npm run dev`ë¡œ ì‹¤í–‰
```json
//package.json
"scripts": {
  "dev": "webpack",
}
```

- 3. `npx webpack` ìœ¼ë¡œ ì‹¤í–‰



## webpack.config.js
- webpack.config.jsê°€ ë³€ê²½ë˜ë©´ ìƒˆë¡œê³ ì¹¨ì´ í•„ìˆ˜

[zerocho ë¸”ë¡œê·¸ ì°¸ê³ ](https://www.zerocho.com/category/Webpack/post/58aa916d745ca90018e5301d)
[zerocho ìœ íˆ¬ë¸Œ react ì›¹ê²Œì„ ì°¸ê³ ](https://www.youtube.com/playlist?list=PLcqDmjxt30RtqbStQqk-eYMK8N-1SYIFn)
[webpack ê³µì‹ë¬¸ì„œ](https://webpack.js.org/configuration/entry-context/)

### mode
- ê°œë°œìš©ì€ development ë°°í¬ìš©(ì‹¤ì„œë¹„ìŠ¤ìš©)ì€ production (ë°°í¬ìš©ì€ ìë™ìœ¼ë¡œ ìµœì í™”ê°€ ì ìš©ë˜ì–´ ìµœì í™” í”ŒëŸ¬ê·¸ì¸ë“¤ì´ ë§ì´ í˜¸í™˜ë˜ì§€ ì•ŠìŒ)
### devtool
- ê°œë°œì‹œì—” 'eval', ë°°í¬ìš©ì€ 'hidden-source-map'ì„ ë§ì´ ì“´ë‹¤ê³  í•œë‹¤
- 'eval'ì€ ë¹ ë¥´ê³  'hidden-source-map'ì€ ì†ŒìŠ¤ ìˆ¨ê¸°ê¸°

```json
devtool: 'eval',
```

### resovle
- í™•ì¥ìëŠ” entryì— js, jsx, css, json ë“± ì—¬ëŸ¬ê°€ì§€ë¥¼ ì…ë ¥í•  ìˆ˜ ìˆëŠ”ë° ë‹¤ ì ê¸° ê·€ì°®ë‹¤ë©´ resolveì— entry í™•ì¥ìë“¤ì„ ì ì–´ì£¼ì–´ ìë™ìœ¼ë¡œ ì¸ì‹í•˜ê²Œ í•˜ë©´ ëœë‹¤

```json
resolve: {
  inextensions: ['.js', '.jsx'],
},
entry: {
  index: ['./a', './c'],
},
```


### entry - ì…ë ¥
- ì›¹íŒ©ì´ íŒŒì¼ì„ ì½ì–´ë“¤ì´ê¸° ì‹œì‘í•˜ëŠ” íŒŒì¼ ê²½ë¡œë¡œ ì´ entryë¥¼ í†µí•´ ëª¨ë“ˆë“¤ì„ ë¡œë”©í•˜ê³  í•˜ë‚˜ì˜ íŒŒì¼ë¡œ ë¬¶ëŠ”ë‹¤
- entryì˜ í‚¤ê°€ index.jsë©´ index.jsë¡œ í†µí•©ëœë‹¤

```json
entry: {
  index: 'íŒŒì¼ ê²½ë¡œ',
}
```

- entryì˜ í‚¤ë¥¼ ì—¬ëŸ¬ê°œ ë„£ìœ¼ë©´ ì—¬ëŸ¬ JS íŒŒì¼ë¡œ ê²°ê³¼ë¬¼ì´ ë§Œë“¤ì–´ì§„ë‹¤. ë³´í†µ ë©€í‹°í˜ì´ì§€ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ì‚¬ìš©í•œë‹¤ê³  í•œë‹¤

```json
entry: {
  index: ['./a.js', './b.js'],
}
```

- ë§Œì•½ a.jsì—ì„œ ì´ë¯¸ b.jsë¥¼ ë¶ˆëŸ¬ì˜¤ê³  ìˆë‹¤ë©´ b.jsë¥¼ ì ì„ í•„ìš”ê°€ ì—†ë‹¤

```json
entry: {
  index: ['./a.js'],
}
```


### module
ì ìš©í•  ëª¨ë“ˆì„ ëª…ì‹œ
- `test: /\.jsx?/` - jsì™€ jsxì— ì ìš©í•œë‹¤
- loader - ì ìš©í•  rule
- options - ruleì˜ ì˜µì…˜
  - presetsì™€ pluginsëŠ” ì•„ë˜ ì˜ˆì‹œì²˜ëŸ¼ ë‚˜ëˆ ì„œ ì‘ì„±

```json
module: {
  rules: [{
    test: /\.jsx?$/,
    loader: 'babel-loader',
    options: {
      presets: [
        '@babel/preset-env', 
        '@babel/preset-react'
      ],
      plugins: ['@babel/plugin-proposal-class-properties'],
    }
  }],
}
```

- preset-envì— ëŒ€í•œ ì˜µì…˜ì„ ì„¤ì •í•˜ê³  ì‹¶ë‹¤ë©´ presetì„ ë°°ì—´ë¡œ ê°ì‹¸ê³  í´ë˜ìŠ¤ë¥¼ í•­ëª©ìœ¼ë¡œ ì¶”ê°€í•´ ì˜µì…˜ì„ ì„¤ì •í•œë‹¤
  - [ë¸Œë¼ìš°ì € ë¦¬ìŠ¤íŠ¸](https://github.com/browserslist/browserslist)ì—ì„œ ë¸Œë¼ìš°ì € ì˜µì…˜ë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤
  
```json
module: {
	...
  
    options: {
      presets: [
        ['@babel/preset-env', {
          targets: {
            browsers: ['> 5% in KR', 'last 2 chrome versions'],
          },
          debug: true,
        }],
         '@babel/preset-react'
        ],
      ...
    }
```


### plugins
ì›¹íŒ©ì˜ í™•ì¥ í”„ë¡œê·¸ë¨ (ê²°ê³¼ë¬¼ì˜ í˜•íƒœë¥¼ ë³€í˜•)
- ì‹¤ë¬´ì—ì„œ ëª‡ ê°€ì§€ ì‚¬ìš©ëœë‹¤
- ì•„ë˜ ì˜ˆì‹œëŠ” ë¡œë”ë“¤ì— ëª¨ë‘ debug: true ì˜µì…˜ì„ ì¶”ê°€í•˜ëŠ” ê¸°ëŠ¥

```json
plugins: [
  new webpack.LoaderOptionsPlugin({debug: true}),
],
```

### output - ì¶œë ¥

entryë¡œ ì°¾ì€ ëª¨ë“ˆì„ í•˜ë‚˜ë¡œ ë¬¶ì€ ê²°ê³¼ë¬¼ì„ ë°˜í™˜í•˜ëŠ” ìœ„ì¹˜
- ë§Œì•½ í˜„ì¬ í´ë” ì•ˆì— distê°€ ìˆê³  ê±°ê¸°ì— ì¶œë ¥ì„ í•˜ë ¤í•œë‹¤ë©´í˜„ì¬ í´ë”ì™€ ê·¸ ì•ˆì— ë“¤ì–´ìˆëŠ” distë¥¼ í•©ì¹˜ë„ë¡ í•˜ë©´ ëœë‹¤ 

```json
output: {
  path: path.join(__dirname, 'dist'),
  filename: 'index.js',
},
```



```javascript
//webpack.congif.js
const path = require('path');
const webpack = require('webpack');

module.exports = {
  mode: 'development'
  resolve: {
  	extensions: ['jsx', 'js'],
  }, 
  entry: {
    index: './pages/index',
  }
  module: {
    rules: [{
      test: /\.jsx?$/,
      loader: 'babel-loader',
      options: {
        presets: [
          ['@babel/preset-env', {
              targets: {
                browsers: ['> 1% in KR'],
              },
              debug: true,
          }],
          '@babel/preset-react'
        ],
        plugins: [],
      }
    }],
  },
  output: {
    path: path.resolve(__dirname, 'dist/js'),
    filename: 'index.js'
  },
  devtool: 'eval',
};
```

## hot loader && webpack-dev-server
[zerocho ìœ íˆ¬ë¸Œ ì°¸ê³ ](https://www.youtube.com/watch?v=pzjvKB1Dkno)

- hot loader ì—ì„œ react-refreshë¡œ ë°”ë€Œì—ˆë‹¤
- reactê°€ ì›ë˜ reloadingì€ í•´ì¤€ë‹¤ (ë³€ê²½ë˜ë©´ ìƒˆë¡œê³ ì¹¨)
  - hot reloadingì€ **ê¸°ì¡´ ë°ì´í„°ë¥¼ ìœ ì§€**í•˜ë©´ì„œ ìƒˆë¡œê³ ì¹¨ì„ í•´ì¤€ë‹¤ëŠ” ê²ƒì´ ì£¼ìš” íŠ¹ì§•


### ì„¤ì¹˜
```shell
npm i react-refresh @pmmmwh/react-refresh-webpack-plugin -D
npm i webpack-dev-server -D
```

### ëª…ë ¹ì–´

`npm run dev` ë¡œ ì‹¤í–‰

```json
//package.json
"scripts": {
  "dev": "webpack server --env development"
}
```

### webpack.config.js

- react-refresh í”ŒëŸ¬ê·¸ì¸ì„ ë¶ˆëŸ¬ì™€ì„œ pluginsì— ì„¤ì •
- moduleì˜ pluginsì— react-refresh ëª…ì‹œ
- devServerì— outputì˜ publicPathë¥¼ ë„£ê³  hot: trueë¡œ ì„¤ì •

```json
//webpack.config.js

const RefreshWebpackPlugin = requir('@pmmmwh/react-refresh-webpack-plugin');

...

module: {
  rules: [{
    ...
    options: {
      presets: [
        ...
      ],
      plugins: [
		'react-refresh/babel',
      ],
    }
  }],
},


plugins: [
  new RefreshWebpackPlugin()
],
output: {
  path: path.resolve(__dirname, 'dist/js'),
  filename: 'index.js'
  publicPath: '/dist/',
},
devServer: {
  publicPath: '/dist/',
  hot: true,
},
```


<details>
<summary>ì˜ˆì „ webpack-dev-serverì™€ hot loader ì„¤ëª… (&& publicPath vs path ì„¤ëª…)</summary>

- webpack-dev-server - ìˆ˜ì •ì‚¬í•­ì´ ë°œê²¬ëì„ ë•Œ ìë™ìœ¼ë¡œ í”„ë¡œê·¸ë¨ì„ ì¬ì‹¤í–‰í•´ì£¼ê³  ê°œë°œ ì„œë²„ë¥¼ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ (webpack.config.jsë¥¼ ì½ì–´ì„œ ë¹Œë“œí•˜ê³  í•­ìƒ ì„œë²„ë¡œ ìœ ì§€ì‹œí‚¨ë‹¤ localhost:8080)
- react-hot-loader - ìˆ˜ì •ì‚¬í•­ì„ ê°ì§€í•˜ëŠ” ê¸°ëŠ¥

```json
//webpack.config.js
plugins: [
  'react-hot-loader/babel',
]
```

- webpack-dev-serverë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” dist/index.jsì²˜ëŸ¼ ê²½ë¡œë¥¼ ì“°ì§€ ì•Šê³  ë°”ë¡œ íŒŒì¼ëª…ë§Œ ëª…ì‹œí•´ì•¼í•œë‹¤
  - path: ì‹¤ì œ ê²½ë¡œ
  - publicPath: ê°€ìƒì˜ ê²½ë¡œ (NodeJSì˜ express.staticê³¼ ìœ ì‚¬)
  
```html
<!-- index.html-->
<script src='./index.js'></script>
```
- ìŠ¤í¬ë¦½íŠ¸ ê²½ë¡œë¥¼ ë°”ê¿”ë„ ëœë‹¤

```json
//webpack.config.js
output: {
  ...
  publicPath: '/dist/',
}
```

```html
<!-- index.html-->
<script src='./dist/index.js'></script>
```

- webpack.config.jsê°€ ë³€ê²½ë˜ë©´ ìƒˆë¡œê³ ì¹¨ì´ í•„ìˆ˜
  
</details>