---
title: '자료 구조 heap'
category: "Algorithm"
date: "2021-03-14 12:00:00 +09:00"
desc: "codingtest, python heapq"
thumbnail: "./images/markdown-test/thumbnail.jpg"
alt: "markdown logo"
---

## heap
- 이진 트리 기반으로 모든 노드가 특정한 순서로 배치되어 있는 자료구조
- 최소 힙(min heap)과 최대 힙(max heap)이 있다
  - 최소 힙은 부모 노드의 값이 자식 노드의 값보다 작은 것
  - 최대 힙은 부모 노드의 값이 자식 노드의 값보다 큰 것
- 힙은 배열에 저장되며 python에서는 heapq 모듈을 사용한다

### 최소 힙 push 과정 (항목 삽입)
- python의 heapq는 최소 힙 구조다
- [7, 1, 4, 3, 5] 를 힙에 순서대로 삽입해보자

```python
import heapq

values = [7, 1, 2, 3, 6]

for value in values:
    heapq.heappush(heap, value)
    print(heap)
```

- 순서대로 힙에 삽입한 결과는 다음과 같다

```
[7]
[1, 7]
[1, 7, 2]
[1, 3, 2, 7]
[1, 3, 2, 7, 6]
```
- 순서가 뒤죽박죽인 것처럼 보이지만 두 가지 규칙을 생각하면 순서가 이해된다
  - 상단의 왼쪽 노드부터 차례대로 배치한다
  - 아래 노드값이 더 작으면 위의 노드와 자리를 바꾼다

1. 7을 루트에 배치
2. 1을 둘째 줄 왼쪽 노드에 배치
3. 1이 7보다 작으므로 1과 7의 자리 변경
4. 2를 둘째 줄 오른쪽 노드에 배치
5. 3을 셋째 줄 첫 노드에 배치 (7의 왼쪽)
6. 3이 7보다 작으므로 3과 7 위치 변경
7. 6을 셋째 줄 두번 째 노드에 배치

![image](https://user-images.githubusercontent.com/52592748/111057287-a109d080-84c9-11eb-9977-6e27f6ba576e.png)

### 최소 힙 pop 과정 (항목 삭제)
- 이번에는 위의 heap에서 가장 작은 항목들부터 하나씩 pop해보자

```python
print(heap)

while heap:
    heapq.heappop(heap)
    print(heap)
```

- 과정은 다음과 같다

```
[1, 3, 2, 7, 6]
[2, 3, 6, 7]
[3, 7, 6]
[6, 7]
[7]
[]
```

- 삭제의 규칙은 다음과 같다
  - 루트 노드를 제거한다
  - 루트 노드에 가장 마지막 노드를 배치한다 (가장 하단 우측에 위치한 노드)
  - 부모 노드의 값이 자신의 자식 노드의 값보다 작아질 때까지 위치를 바꾼다
  - 이 때, 자식 노드 중 더 작은 값을 가진 노드와 자리를 바꾼다

1. 루트 노드 1 제거
2. 마지막 노드 6을 루트로 이동
3. 6는 3이나 2보다 작으므로 자리 변경 필요. 2와 3 중 더 작은 값을 지닌 2와 자리 변경
4. 루트 노드 2 제거
5. 마지막 노드 7을 루트로 이동
6. 7은 3이나 6보다 작으므로 자리 변경 필요. 3과 6 중 더 작은 값을 지닌 3과 자리 변경
7. 루트 노드 3 제거
8. 마지막 노드 6을 루트로 이동
9. 루트 노드 6 제거
10. 마지막 노드 7을 루트로 이동
11. 루트 노드 7 제거

![image](https://user-images.githubusercontent.com/52592748/111057296-ac5cfc00-84c9-11eb-9d9f-1acda3fc360c.png)